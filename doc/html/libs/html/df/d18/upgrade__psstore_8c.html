<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LIBS: upgrade_psstore.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LIBS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('df/d18/upgrade__psstore_8c.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">upgrade_psstore.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="elRef" doxygen="C:/ws/j_adk64r_RC_build_aurad_ext/devkit/build/doc_doxygen_ext_adk64r_RC_CI_qcc512x_qcc302x_1908091004/progfiles/doc/html/os/os.tag:../../../../os/html/" href="../../../../os/html/dc/da9/csrtypes_8h.html">csrtypes.h</a>&gt;</code><br />
<code>#include &lt;<a class="elRef" doxygen="C:/ws/j_adk64r_RC_build_aurad_ext/devkit/build/doc_doxygen_ext_adk64r_RC_CI_qcc512x_qcc302x_1908091004/progfiles/doc/html/os/os.tag:../../../../os/html/" href="../../../../os/html/df/d1f/panic_8h.html">panic.h</a>&gt;</code><br />
<code>#include &lt;ps.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/d77/print_8h_source.html">print.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d2/d42/upgrade_8h_source.html">upgrade.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="../../db/d0e/upgrade__ctx_8h_source.html">upgrade_ctx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/dfa/upgrade__fw__if_8h_source.html">upgrade_fw_if.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d1d/upgrade__psstore_8h_source.html">upgrade_psstore.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d6e/upgrade__psstore__priv_8h_source.html">upgrade_psstore_priv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d07/upgrade__partitions_8h_source.html">upgrade_partitions.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aec2f12ceaf71dcf51e9e83c24014c2e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d18/upgrade__psstore_8c.html#aec2f12ceaf71dcf51e9e83c24014c2e6">UpgradeSavePSKeys</a> (void)</td></tr>
<tr class="memdesc:aec2f12ceaf71dcf51e9e83c24014c2e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">UpgradeSavePSKeys - Save our PSKEYS.  <a href="#aec2f12ceaf71dcf51e9e83c24014c2e6">More...</a><br /></td></tr>
<tr class="separator:aec2f12ceaf71dcf51e9e83c24014c2e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a489c6a48e03ca20d0d7b2d79518e6166"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d18/upgrade__psstore_8c.html#a489c6a48e03ca20d0d7b2d79518e6166">UpgradePSSpaceForCriticalOperations</a> (void)</td></tr>
<tr class="memdesc:a489c6a48e03ca20d0d7b2d79518e6166"><td class="mdescLeft">&#160;</td><td class="mdescRight">UpgradePSSpaceForCriticalOperations.  <a href="#a489c6a48e03ca20d0d7b2d79518e6166">More...</a><br /></td></tr>
<tr class="separator:a489c6a48e03ca20d0d7b2d79518e6166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a995e2c5cd2d544472ab2c60e2183ddce"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d18/upgrade__psstore_8c.html#a995e2c5cd2d544472ab2c60e2183ddce">UpgradeGetVersion</a> (uint16 *major, uint16 *minor, uint16 *<a class="el" href="../../d8/db1/audio__output__private_8h.html#a1cc48b609ff96992ffe3316b16e5f464">config</a>)</td></tr>
<tr class="memdesc:a995e2c5cd2d544472ab2c60e2183ddce"><td class="mdescLeft">&#160;</td><td class="mdescRight">UpgradeGetVersion.  <a href="#a995e2c5cd2d544472ab2c60e2183ddce">More...</a><br /></td></tr>
<tr class="separator:a995e2c5cd2d544472ab2c60e2183ddce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae282724d8a3cb39db39637b990e9318d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d18/upgrade__psstore_8c.html#ae282724d8a3cb39db39637b990e9318d">UpgradeGetInProgressVersion</a> (uint16 *major, uint16 *minor, uint16 *<a class="el" href="../../d8/db1/audio__output__private_8h.html#a1cc48b609ff96992ffe3316b16e5f464">config</a>)</td></tr>
<tr class="memdesc:ae282724d8a3cb39db39637b990e9318d"><td class="mdescLeft">&#160;</td><td class="mdescRight">UpgradeGetInProgressVersion.  <a href="#ae282724d8a3cb39db39637b990e9318d">More...</a><br /></td></tr>
<tr class="separator:ae282724d8a3cb39db39637b990e9318d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5488f6db5bb885955cbb7ed83cd7b68"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d18/upgrade__psstore_8c.html#aa5488f6db5bb885955cbb7ed83cd7b68">UpgradePartialUpdateInterrupted</a> (void)</td></tr>
<tr class="memdesc:aa5488f6db5bb885955cbb7ed83cd7b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">UpgradePartialUpdateInterrupted.  <a href="#aa5488f6db5bb885955cbb7ed83cd7b68">More...</a><br /></td></tr>
<tr class="separator:aa5488f6db5bb885955cbb7ed83cd7b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt>DESCRIPTION</dt><dd>Implementation of an interface to Persistent Storage to get details of the file system and anything else related to the possibilities of upgrade. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Errors. Cause panics. End of. This behaviour in itself is problematic but if we are trying to switch applications then an error should indicate a reason to restart. We can't really delegate this to the VM app. We can't wind back to a previous application. Caching. Persistent store keys are not cached. There isn't a mechanism to subscribe to PSKEY changes. Since we don't actually expect to be called that frequently it makes sense to access the keys we need when we need them. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae282724d8a3cb39db39637b990e9318d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae282724d8a3cb39db39637b990e9318d">&#9670;&nbsp;</a></span>UpgradeGetInProgressVersion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UpgradeGetInProgressVersion </td>
          <td>(</td>
          <td class="paramtype">uint16 *&#160;</td>
          <td class="paramname"><em>major</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16 *&#160;</td>
          <td class="paramname"><em>minor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16 *&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UpgradeGetInProgressVersion. </p>
<p>Get the "in progress" version information from the upgrade library.</p>
<dl class="section user"><dt>DESCRIPTION</dt><dd>Get the "in progress" version information from the PS keys. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>

</div>
</div>
<a id="a995e2c5cd2d544472ab2c60e2183ddce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a995e2c5cd2d544472ab2c60e2183ddce">&#9670;&nbsp;</a></span>UpgradeGetVersion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UpgradeGetVersion </td>
          <td>(</td>
          <td class="paramtype">uint16 *&#160;</td>
          <td class="paramname"><em>major</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16 *&#160;</td>
          <td class="paramname"><em>minor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16 *&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UpgradeGetVersion. </p>
<p>Get the version information from the upgrade library.</p>
<dl class="section user"><dt>DESCRIPTION</dt><dd>Get the version information from the PS keys. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>

</div>
</div>
<a id="aa5488f6db5bb885955cbb7ed83cd7b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5488f6db5bb885955cbb7ed83cd7b68">&#9670;&nbsp;</a></span>UpgradePartialUpdateInterrupted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UpgradePartialUpdateInterrupted </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UpgradePartialUpdateInterrupted. </p>
<p>Get an indication of whether a partial upgrade has been interrupted.</p>
<dl class="section user"><dt>DESCRIPTION</dt><dd>Get the indication of whether a partial upgrade has been interrupted from the PS keys. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>

</div>
</div>
<a id="a489c6a48e03ca20d0d7b2d79518e6166"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a489c6a48e03ca20d0d7b2d79518e6166">&#9670;&nbsp;</a></span>UpgradePSSpaceForCriticalOperations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UpgradePSSpaceForCriticalOperations </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UpgradePSSpaceForCriticalOperations. </p>
<dl class="section user"><dt>DESCRIPTION</dt><dd>Checks whether there appears to be sufficient free space in the PSSTORE to allow upgrade PSKEY operations to complete. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>FALSE if insufficient space by some metric, TRUE otherwise. </dd></dl>

</div>
</div>
<a id="aec2f12ceaf71dcf51e9e83c24014c2e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec2f12ceaf71dcf51e9e83c24014c2e6">&#9670;&nbsp;</a></span>UpgradeSavePSKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeSavePSKeys </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UpgradeSavePSKeys - Save our PSKEYS. </p>
<p>UpgradeSavePSKeys.</p>
<dl class="section user"><dt>DESCRIPTION</dt><dd>Save our PSKEYS into Persistent Storage. </dd></dl>
<dl class="section user"><dt></dt><dd>The existing contents of the key are read first. If they chance not to exist the the value we do not control are set to 0x0000 (deemed safer than panicking or using a marker such as 0xFACE) </dd></dl>
<dl class="section user"><dt></dt><dd>Note that the upgrade library initialisation has guaranteed that the the pskeys fit within the 64 words allowed. </dd></dl>
<dl class="section user"><dt></dt><dd>Although not technically part of our API, safest if we allow for the PSKEY to be longer than we use. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_9104b11b055a08855e18ab07d1360a34.html">apps_ext_adk64r_RC_CI_qcc512x_qcc302x_1908091004</a></li><li class="navelem"><a class="el" href="../../dir_19c4644e84b768df42bf93899dbb4e83.html">apps_package</a></li><li class="navelem"><a class="el" href="../../dir_e9f51238b5eab91050ba7b42263dc658.html">progfiles</a></li><li class="navelem"><a class="el" href="../../dir_86fefe393b7ca9a63838560cf4ca04cf.html">apps</a></li><li class="navelem"><a class="el" href="../../dir_4741f709c1c589b2cd57d229d2794b05.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_e4826ee8ae7389fdbf679a5c41d02724.html">upgrade</a></li><li class="navelem"><a class="el" href="../../df/d18/upgrade__psstore_8c.html">upgrade_psstore.c</a></li>
    <li class="footer">Copyright (c) 2019 Qualcomm Technologies International, Ltd. Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
