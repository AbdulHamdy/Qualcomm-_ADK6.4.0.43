<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>kcc: User manual</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">kcc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">kcc documentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">User manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is kcc, the driver program for the Kalimba C compiler.</p>
<h1><a class="anchor" id="introduction"></a>
Introduction</h1>
<p>The kcc driver program arranges to run the tools which go to make up the Kalimba C compiler package. For the bulk of users, the driver is the C compiler since it is the only command they need to invoke when building C programs.</p>
<p>As it drives multiple tools, kcc presents many command-line options. Some of these are specific to one tool, but others control many tools. Where possible, options mimic those of existing compiler drivers such as that used with GCC, though there are exceptions.</p>
<h2><a class="anchor" id="tools"></a>
Tools which can be invoked</h2>
<p>The driver invokes some of the following stages:</p>
<dl>
<dt><b>compiler</b></dt>
<dd>turning C source code into assembly code </dd>
<dt><b>assembler</b></dt>
<dd>turning assembly code into object files </dd>
<dt><b>linker</b></dt>
<dd>combining object files and libraries to produce an ELF file </dd>
</dl>
<h2><a class="anchor" id="extensions"></a>
Filename extensions</h2>
<p>Extensions on filenames are used to indicate their contents and (as such) which tools handle the contents.</p>
<dl>
<dt><b>file.c</b></dt>
<dd>C source file, to be preprocessed and compiled </dd>
<dt><b>file.i</b></dt>
<dd>C source file, already preprocessed </dd>
<dt><b>file.s</b></dt>
<dd>assembly source file </dd>
<dt><b>file.asm</b></dt>
<dd>assembly source file </dd>
<dt><b>file.o</b></dt>
<dd>object file for linking </dd>
<dt><b>file.a</b></dt>
<dd>library (archive) file for linking </dd>
<dt><b>file.link</b></dt>
<dd>linker control file (linkscript) </dd>
</dl>
<p>Files with an unrecognised extension are treated as an error. Unlike GCC, there's no way to indicate a file's contents other than through the extension (-x language is not supported.) Also unlike GCC, extensions are compared in a case-insensitive manner, so .C and .c are handled in the same way.</p>
<h1><a class="anchor" id="options"></a>
Command-line options</h1>
<h2><a class="anchor" id="options_stages"></a>
Stages</h2>
<dl>
<dt><b>-E,-P</b></dt>
<dd>stop after the preprocessor has run. Preprocessor output is controlled via -o. </dd>
<dt><b>-S</b></dt>
<dd>stop after the compiler ihas been invoked (only output assembly files) </dd>
<dt><b>-c</b></dt>
<dd>stop after the assembler (only output object files; do not perform a final link) </dd>
</dl>
<h2><a class="anchor" id="options_support"></a>
Support</h2>
<dl>
<dt><b>-h</b></dt>
<dd>print version information and command line help </dd>
<dt><b>-v</b></dt>
<dd>print out version information for all tools invoked, including the kcc driver </dd>
<dt><b>-n</b></dt>
<dd>report commands rather than running them </dd>
<dt><b>-B<em>prefix</em></b></dt>
<dd>set search prefix for tools, libraries and include files </dd>
<dt><b>-save-temps</b></dt>
<dd>don't delete intermediate .s and .o files - very useful to inspect assembly generated by the compiler </dd>
</dl>
<h2><a class="anchor" id="options_output"></a>
Output files</h2>
<p>If linking, an output filename must be specified using -o. There is no default to "a.out" for the link stage.</p>
<p>If not linking, and only a single input file is given on the command-line, an output filename may be specified using -o, in which case the name is used as is, including any extensions.</p>
<p>If not linking, and multiple input files are given, then the output filenames are derived from the input filenames by changing the extensions to match the "next stage" in the tool flow.</p>
<h2><a class="anchor" id="options_general"></a>
General</h2>
<dl>
<dt><b>-g</b></dt>
<dd>enable debug builds </dd>
<dt><b>-k<em>chipname</em></b></dt>
<dd>specify target chip name: use -h for a list of valid chips </dd>
<dt><b>-minim</b></dt>
<dd>target MiniMode instruction set (compatible targets only) </dd>
</dl>
<h2><a class="anchor" id="options_preprocessor"></a>
Preprocessor</h2>
<dl>
<dt><b>-dM</b></dt>
<dd>dump list of preprocessor defines to stdout </dd>
<dt><b>-P</b></dt>
<dd>preprocess only; don't include <code>#line/#file</code> directives when preprocessing </dd>
<dt><b>-D</b></dt>
<dd>define a preprocessor macro </dd>
<dt><b>-U</b></dt>
<dd>undefine a preprocessor macro </dd>
<dt><b>-I</b></dt>
<dd>add a directory to the compiler's include path for preprocessing </dd>
</dl>
<h2><a class="anchor" id="options_compiler"></a>
Compiler</h2>
<dl>
<dt><b>-dp</b></dt>
<dd>show matched compiler rules in generated assembly </dd>
<dt><b>-no-debug-inline</b></dt>
<dd>avoid copying inline functions in debug mode - inlined code may not be debuggable </dd>
<dt><b>-mark_code_section_type</b></dt>
<dd>Append '__minim' or '__maxim' to assigned code sections based on the chosen instruction set for each compilation unit </dd>
<dt><b>-MD</b></dt>
<dd>generate make dependency files for compiled code </dd>
<dt><b>-MF <em>&lt;filename&gt;</em></b></dt>
<dd>specify filename for generated make dependency file </dd>
<dt><b>-MT <em>&lt;target name&gt;</em></b></dt>
<dd>specify target for generated make dependency file </dd>
<dt><b>-O0</b></dt>
<dd>skip many code optimisations </dd>
<dt><b>-O1</b></dt>
<dd>skip copy propagation for slightly better debug info than -O2/-Osize </dd>
<dt><b>-O2</b></dt>
<dd>identical to -Osize </dd>
<dt><b>-O3</b></dt>
<dd>identical to -Ospeed </dd>
<dt><b>-Osize</b></dt>
<dd>enable optimisations aiming at most compact code size (the default) </dd>
<dt><b>-Ospeed</b></dt>
<dd>enable optimisations aiming at fastest code execution </dd>
<dt><b>-old-mangling</b></dt>
<dd>revert to old symbol mangling scheme for autogenerated data labels (L_x instead of A_x) </dd>
<dt><b>-optional-reads</b></dt>
<dd>restore pre-KCC 40 behaviour of implementing optional reads of volatile objects </dd>
<dt><b>-pic</b></dt>
<dd>generate a limited form of position independent code </dd>
<dt><b>-W[level|WarningName|noWarningName]</b></dt>
<dd>enable or disable warnings by category, or individually. Valid categories are: <b>none</b>, <b>all</b> and <b>strict</b> </dd>
</dl>
<h2><a class="anchor" id="options_assembler"></a>
Assembler</h2>
<dl>
<dt><b>-A<em>path</em></b></dt>
<dd>add an include path to the assembler </dd>
<dt><b>-mark_code_section_type</b></dt>
<dd>Append '__minim' or '__maxim' to assigned code sections based on the chosen instruction set for each module </dd>
</dl>
<h2><a class="anchor" id="options_linker"></a>
Linker</h2>
<dl>
<dt><b>-L<em>path</em></b></dt>
<dd>add a library search path for libraries included via -l </dd>
<dt><b>-l<em>xyz</em></b></dt>
<dd>shorthand for linking in the archive <em>libxyz.a</em>  </dd>
<dt><b>-mno-crt0</b></dt>
<dd>don't link in crt0.o automatically  </dd>
<dt><b>-mno-libc</b></dt>
<dd>don't link in libc.a automatically  </dd>
<dt><b>-mno-libcrt</b></dt>
<dd>don't link in libcrt.a (basic C runtime) automatically  </dd>
<dt><b>-mno-libfle</b></dt>
<dd>don't link in libfle.a (floating point emulation) automatically  </dd>
<dt><b>-nodefaultlibs</b></dt>
<dd>don't automatically link crt0 or any C libraries (no crt0, libc, libcrt, libfle) </dd>
<dt><b>-no-relax</b></dt>
<dd>turn off relaxation in the linker </dd>
<dt><b>-gc-sections</b></dt>
<dd>enable garbage collection in the linker (discards unused code and data) </dd>
</dl>
<p>Take care with the <b>-mno-libcrt</b> and <b>-mno-libfle</b> options. Ordinary C code can induce a dependency on these libraries. libcrt.a provides basic functionality for C language constructs such as long long shifts. libfle.a covers all floating point support, so you will need this library if using float, double or long double types (or, for example, printf(), which has support for printing floating point numbers).</p>
<p>If there are no C source or object files in your list of inputs, you should use the individual -m options to avoid trying to link C libraries automatically. For convenience, <b>-nodefaultlibs</b> is provided, which has the same effect as specifying <b>-mno-crt0</b>, <b>-mno-libc</b>, <b>-mno-libcrt</b> and <b>-mno-libfle</b>.</p>
<p>Note that if you wish to enable garbage collection in the linker, you will need to specify the entry point of your code by using the "start" directive in your linkscript. The default linkscripts shipped with KCC designate "$_crt0_start" as the entry point.</p>
<h2><a class="anchor" id="options_passthrough"></a>
Pass through options</h2>
<dl>
<dt><b>-Xcompiler <em>&lt;option&gt;</em></b> </dt>
<dd></dd>
<dt><b>-Xc <em>&lt;option&gt;</em></b> </dt>
<dd>Passes <em>&lt;option&gt;</em> directly to the compiler executable. If <em>&lt;option&gt;</em> contains spaces, the whole option should be contained within double quotes ("). </dd>
<dt><b>-Xassembler <em>&lt;option</em>&gt;</b> </dt>
<dd></dd>
<dt><b>-Xa <em>&lt;option&gt;</em></b> </dt>
<dd>As above, but <em>&lt;option&gt;</em> is passed to the assembler executable. </dd>
<dt><b>-Xlinker <em>&lt;option&gt;</em></b> </dt>
<dd></dd>
<dt><b>-Xl <em>&lt;option&gt;</em></b> </dt>
<dd>As above, but <em>&lt;option</em>&gt; is passed to the linker executable. </dd>
</dl>
<h1><a class="anchor" id="Restrictions"></a>
Restrictions</h1>
<p>Use of the preprocessor is limited to C source files. There's no support for invoking it for files with arbitrary extensions or for assembler source files. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 20 2019 11:09:30 for kcc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
